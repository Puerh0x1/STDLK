<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#6366f1">
    <title>Главная - Личный Кабинет СТД РФ</title>
    
    <!-- Критические inline стили для мгновенной загрузки -->
    <style>
        /* Предотвращаем мерцание */
        html { visibility: hidden; opacity: 0; }
        
        /* Базовые цвета */
        :root {
            --primary: #6366f1;
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --border-color: #e2e8f0;
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --sidebar-width: 280px;
        }
        
        [data-theme="dark"] {
            --primary: #818cf8;
            --bg-primary: #0f172a;
            --bg-secondary: #1e293b;
            --text-primary: #f1f5f9;
            --text-secondary: #cbd5e1;
            --border-color: #334155;
        }
        
        /* Базовая структура */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        body.content-ready { opacity: 1; }
        
        /* Прелоадер */
        .page-init-loader {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            z-index: 999999;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .page-init-loader.hidden {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        
        .loader-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-color);
            border-top-color: var(--primary);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        
        /* Скрываем контент до загрузки */
        .main-container-modern { opacity: 0; }
        .main-container-modern.loaded { 
            opacity: 1; 
            transition: opacity 0.4s ease;
        }
    </style>
    
    <!-- Немедленная инициализация темы -->
    <script>
        (function() {
            // Применяем тему сразу
            const theme = localStorage.getItem('modern-theme') || 'light';
            document.documentElement.setAttribute('data-theme', theme);
            
            // Обновляем meta theme-color
            const meta = document.querySelector('meta[name="theme-color"]');
            if (meta) meta.content = theme === 'dark' ? '#0f172a' : '#6366f1';
        })();
    </script>
    
    <!-- Предзагрузка критических ресурсов -->
    <link rel="preload" href="assets/css/modern-theme-fixed.css" as="style">
    <link rel="preload" href="assets/js/instant-load.js" as="script">
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" as="style">
    
    <!-- Основные стили -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <link href="assets/css/modern-theme-fixed.css" rel="stylesheet">
</head>
<body>
    <!-- Прелоадер -->
    <div class="page-init-loader" id="pageLoader">
        <div class="loader-spinner"></div>
    </div>
    
    <!-- Основной контент -->
    <div class="main-container-modern" id="mainContainer">
        <!-- Здесь идет весь контент страницы -->
    </div>
    
    <!-- Скрипт быстрой инициализации -->
    <script>
        // Быстрая инициализация
        (function() {
            const loader = document.getElementById('pageLoader');
            const container = document.getElementById('mainContainer');
            
            // Функция показа контента
            function showContent() {
                document.documentElement.style.visibility = 'visible';
                document.documentElement.style.opacity = '1';
                document.body.classList.add('content-ready');
                
                if (loader) {
                    loader.classList.add('hidden');
                    setTimeout(() => loader.remove(), 300);
                }
                
                if (container) {
                    container.classList.add('loaded');
                }
            }
            
            // Проверяем готовность
            if (document.readyState === 'complete') {
                showContent();
            } else {
                window.addEventListener('load', showContent);
                // Таймаут на случай зависания
                setTimeout(showContent, 2000);
            }
        })();
    </script>
    
    <!-- Основные скрипты (загружаются асинхронно) -->
    <script src="assets/js/instant-load.js" defer></script>
    <script src="assets/js/page-transitions.js" defer></script>
    <script src="assets/js/modern-theme-improved.js" defer></script>
</body>
</html>